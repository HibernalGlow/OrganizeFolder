# 压缩包批量解压工具 - 成熟库版本

## 📦 版本说明

### 1. **原版本 (__main__.py) - 基于7z命令**
- ✅ 支持所有7z支持的格式
- ✅ 密码尝试功能完整
- ❌ 需要安装7-Zip软件

### 2. **现代版本 (archive_extractor_v2.py) - 基于Python库**
- ✅ 纯Python实现，无需外部软件
- ✅ 使用成熟的第三方库
- ✅ 更好的错误处理
- ❌ 部分格式可能需要额外库

## 🚀 推荐的成熟库

### **patoolib** - 通用压缩包处理
```bash
pip install patoolib
```
- 支持: ZIP, 7Z, RAR, TAR, GZ, BZ2, XZ等
- 自动检测格式，统一接口

### **py7zr** - 7Z格式专用
```bash
pip install py7zr
```
- 纯Python实现，支持密码保护

### **rarfile** - RAR格式专用
```bash
pip install rarfile
```
- 需要系统安装unrar工具，支持密码保护

---

# 压缩包批量解压工具
### 密码配置

编辑 `passwords.json` 文件来配置密码列表：

```json
{
  "passwords": [
    "",           // 无密码
    "123456",     // 常用密码1
    "password",   // 常用密码2
    "123",        // 常用密码3
    "admin",      // 常用密码4
    "root"        // 常用密码5
  ],
  "description": "密码尝试列表，按顺序从上到下尝试"
}
```

**注意**: 
- 第一个空字符串 `""` 表示无密码
- 程序会按列表顺序依次尝试每个密码
- 可以根据需要添加或删除密码

## 工作流程

1. **扫描阶段**: 
   - 扫描指定路径（文件或文件夹）
   - 识别所有支持的压缩包格式
   - 显示找到的压缩包列表

2. **解压阶段**:
   - 为每个压缩包创建同名目录
   - 按密码列表顺序尝试解压
   - 显示实时进度和状态

3. **重命名阶段**:
   - 为解压出的所有文件和文件夹添加前缀
   - 前缀格式: `压缩包名@原文件名`
   - 避免文件名冲突

## 文件结构示例

### 处理前:
```
/工作目录/
├── photo.zip
├── documents.rar
└── videos.7z
```

### 处理后:
```
/工作目录/
├── photo.zip
├── photo/
│   ├── photo@IMG_001.jpg
│   ├── photo@IMG_002.jpg
│   └── photo@vacation/
├── documents.rar
├── documents/
│   ├── documents@report.pdf
│   └── documents@presentation.pptx
├── videos.7z
└── videos/
    ├── videos@movie1.mp4
    └── videos@movie2.avi
```

## 支持的压缩格式

- **ZIP**: .zip, .cbz
- **RAR**: .rar, .cbr  
- **7-Zip**: .7z
- **TAR**: .tar, .tar.gz, .tar.bz2, .tar.xz
- **其他**: .gz, .bz2, .xz

## 高级功能

### 批量处理
- 支持递归扫描子目录中的压缩包
- 自动跳过已解压的文件（避免重复处理）
- 智能处理文件名冲突

### 错误处理
- 自动跳过损坏的压缩包
- 处理密码错误和超时情况
- 详细的错误日志记录

### 性能优化
- 单个压缩包解压超时保护（5分钟）
- 内存友好的大文件处理
- 并发安全的文件操作

## 故障排除

### 常见问题

1. **"未找到 7z 命令"**
   - 确保已正确安装 7-Zip
   - Windows 用户检查 7z.exe 是否在 PATH 中

2. **解压失败**
   - 检查压缩包是否损坏
   - 确认密码配置是否正确
   - 检查磁盘空间是否充足

3. **重命名失败**
   - 检查文件权限
   - 确认文件未被其他程序占用

### 日志查看

程序会自动记录详细日志到 `logs` 目录，可以查看具体的错误信息和处理记录。

## 注意事项

- 🚨 **备份重要数据**: 处理前请备份重要文件
- ⚠️ **磁盘空间**: 确保有足够空间存储解压文件
- 🔒 **密码安全**: 密码配置文件请妥善保管
- ⏰ **耐心等待**: 大文件解压可能需要较长时间

## 技术特性

- 基于 Python 3.7+ 开发
- 使用 Rich 库提供现代化 CLI 界面
- 采用 7-Zip 引擎确保最大兼容性
- 完整的错误处理和日志记录
- 跨平台支持 (Windows, Linux, macOS)
